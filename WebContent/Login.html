<!DOCTYPE html>
<html lang="en">
<head>
  <title>Login</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" type="text/css" href="style.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
 
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.4.1/css/bootstrap-datepicker3.css"/>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
</head>
<body class="pageBody">

<div class="container">
<div class="formrow">
  <h3>Login</h3> 
  <div class="row">
  	  <form method="post">
    <div class="col-sm-4"> 
     <div class="form-group ">
      <label class="control-label requiredField" for="username">
       Username
       <span class="asteriskField">
        *
       </span>
      </label>
      <input class="form-control" id="username" name="username" type="text"/>
     </div>
       <div class="form-group ">
      <label class="control-label requiredField" for="password">
       Password
       <span class="asteriskField">
        *
       </span>
      </label>
      <div class="input-group">
       <input class="form-control" id="password" name="password" type="password" size="80"/>
      </div>
     </div>
     </div>
    </form>
    </div>
    </div>
    <div class="pageFooter">
    <div class ="row">
        <div class="col-md-1"><div class="form-group">
      <div>
       <button class="btn btn-primary " name="submit" type="submit" id="loginForm">
        Login
       </button>
      </div>
     </div></div>
    </div>
    <br>
    </div>
</div> 
<br><br><br><br><br>
<!-- Extra JavaScript/CSS added manually in "Settings" tab -->
<!-- Include jQuery -->
<script type="text/javascript" src="https://code.jquery.com/jquery-1.11.3.min.js"></script>

<script>


$(document).ready(function() {
$("#loginForm").submit(function (e){
		var username = $('#username').val();
		var password = $('#password').val();

		$.ajax( { 
			url:"/eventplannerJava/eventplanner/userservice/login/", 
			type: "POST",
			dataType: "json",
			contentType: "application/json",
			data: '{'+  
				'"username" : "'+username+'",'+
				'"password" : "'+password+'"'+
			"}",
			statusCode: {
			200: function(response) {
				  document.cookie="token=" + response.responseText;
				  $("#page-message").html("Logged in");
				  window.location.assign("eventsList.html");
		  		},
		  	406: function(response) {
		  		var errors = response.responseJSON;
		  		$(".error").html("*");
		  		$.each(errors, function (i, message) {
		  			$("#"+message.attributeName+"Err").html(message.message);
		  			console.log("Error "+message.attributeName +" "+message.message)
    	        		});
		  		$("#page-message").html("Username and password not found");
		  		},
		  	
			404 : function(jqXHR, textStatus, errorThrown) {
				$("#page-message").html("Error:"+textStatus);
				consule.log(errorThrown);
	  	        console.log("error " + textStatus);
	  	        console.log("incoming Text " + jqXHR.responseText);
	  	      	}
			}
			});

		e.preventDefault();
});
});

</script>
</body>
</html>