<!DOCTYPE HTML> 
<html>
<head>
<link rel="stylesheet" type="text/css" href="style.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>

</head>
<body> 
<script>

// Generates the table marker for the guest.
// The generate table marker button must have an onclick that references this function
// That is if we choose to have this button on the add screen at all.
function generateTableMarker() {
 var req = new XMLHttpRequest();
	 req.open("GET", "/eventplannerJava/eventplanner/reportservice/tablemarkers/"+$.urlParam("id"), true);
	 req.responseType = "blob";
	 req.onload = function (event) {
		 var blob = req.response;
		 console.log(blob.size);
		 var link = document.createElement('a');
		 link.href = window.URL.createObjectURL(blob);
		 link.download = "TableMarker_" + new Date() + ".pdf";
		 link.click();
	 };
	 req.send();
}

$.urlParam = function(name){
    var results = new RegExp('[\?&]' + name + '=([^&#]*)').exec(window.location.href);
    if (results==null){
       return null;
    }
    else{
       return results[1] || 0;
    }
}
function cancel(){
	window.location.assign("guestList.html?id="+$.urlParam('eventid')+"&anthony=anthony");
}
$(document).ready(function() {

	$("#addbtn").on('click', function (e){
		
		var guestName =$('#name').val();
		var note = $('#relationshipDescriptor').val();
		
		$.ajax( { 
			url:"/eventplannerJava/eventplanner/guestservice/guests",
			type: "POST",
			dataType: "json",
			contentType: "application/json",
			data: '{'+  
				'"name" : "'+guestName+'",'+
				'"relationshipDescriptor" :"'+ note+'"'+
			"}",
			statusCode: {
				200: function(response) {
					 window.location.assign("guestList.html?id="+$.urlParam('eventid')+"&anthony=anthony");				 
			  	}
			}
		});
	});
});

function confirmLogout(){
    agree = confirm("Do you want to logout?");
     if(agree){
 		window.location.assign("Logout.html");
 	}
}
</script>
<div>
<ul class="nav">
<li><a href="eventList.html">Event</a></li>
<li><a href="customerList.html">Customer</a></li>
<li><a href="userList.html">Users</a></li>
<li class="logouttab pull-right" role="presentation"><a onclick ="confirmLogout();" href="#">Logout</a></li>
</ul>
</div>
<h2>Add Guest</h2>
<p id ='debug'></p>
<div class ='block-center'>
<p><span class="error-head">* required field.</span></p>
<form id="guestForm" method="post">
   Guest Name: <input type="text" id="name">
   <span id="nameErr" class="error">* </span>
   <br><br>
   Note: <input type="text" id="relationshipDescriptor">
   <span id="relationshipDescriptorErr" class="error">* </span>
   
   <br><br>
</form>
   <button id="addbtn" name="Add" value="Add"> Add </button>

<button id="cancelbtn" onclick="cancel();">Cancel</button>
</div>
</body>
</html>