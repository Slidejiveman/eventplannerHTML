<!DOCTYPE HTML> 
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" type="text/css" href="style.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script type="text/javascript" src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.3/css/select2.min.css" rel="stylesheet" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.3/js/select2.min.js"></script>
  <script type="text/javascript" src="http://cdn.datatables.net/1.10.2/js/jquery.dataTables.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  
<script>

	createTable();

	function selectChange() 
    {
        id = getId();
        $("#selectedID").html(id);
        $("#updateID").val(id);
        $("#deleteID").val(id);   
    }
    
    function getId()
	{ 
	  return jQuery( 'input[name=selectedRow]:checked' ).val()
	}
  
    function createTable() {
    	$.getJSON( "/eventplannerJava/eventplanner/guestservice/guests")
    	  .done(function( response ) {
    		  var tableHTML = '<thead><tr><th></th><th>ID</th><th>Guest Name</th><th>Table Number</th></tr></thead><tbody>';
    	        $.each(response, function (i, guest) {
    	            tableHTML += '<tr><td><input type="radio" onchange= "selectChange()" name="selectedRow" value='+guest.id+'></td><td>' + guest.id + '</td><td>' + guest.name + '</td><td><select class="selectTables">'
    	            +guest.table.number + '</select></td></tr>';
    	        });
    	       tableHTML+='</tbody>';
    	       $('#assignments-list-table').html(tableHTML);})
  	  .fail(function(jqXHR, textStatus, errorThrown) {
  	        console.log("error " + textStatus);
  	        console.log("incoming Text " + jqXHR.responseText);});
      }
</script>

<script>
var agree;
$.urlParam = function(name){
    var results = new RegExp('[\?&]' + name + '=([^&#]*)').exec(window.location.href);
    if (results==null){
       return null;
    }
    else{
       return results[1] || 0;
    }
}
$(document).ready(function(){
    $('#assignments-list-table').dataTable();
    $(".selectTables").select2({
    	ajax:{
	            url: '/eventplannerJava/eventplanner/customerservice/events'+$.urlParam("id")+'/tables',
	            dataType: 'json',
	            type: 'GET',
	            processResults: function (data) {
	                return {
	                    results: $.map(data, function(obj) {
	                        return { id: obj.id, text: obj.number};
	                    })
	                };
	            }
	        }
    });
    
});
</script>
</head>
<body class="pageBody"> 
<div class= "container">
<div class=row>
<ul class="nav nav-pills" >
  <li role="presentation"><a href="eventsList.html">Events</a></li>
  <li role="presentation"><a href="customerList.html">Customers</a></li>
  <li role="presentation"><a href="userList.html">Users</a></li>
  <li class="logouttab pull-right" role="presentation"><a href="Logout.html">Logout</a></li>
</ul>
</div>
<h2>Seating Assignments List</h2>
<div>
<div class="table-responsive">
<table class="table table-striped" id="assignments-list-table" >
</table></div>
<br>
<p id="selectedID"></p>
<div class="footer-buttons">
<form class='inline' action="assignments.html" method="get">
	<input id="updateID" type="hidden" name="id" value="">
     <button class="full btn btn-primary" type = "submit" name="submit" value="Update">Save</button>
</form>

<form class='inline' method="get" action="assignments.html">
  <button class="full btn btn-primary" type = "submit" value="Cancel" id="cancelbtn">Cancel</button>
</form>
</div>
</div>
</div>
</body>
</html>